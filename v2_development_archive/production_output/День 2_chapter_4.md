# Обучение модели распознавания сущностей: от разметки до интеграции в приложение

## Введение

В этой статье мы поговорим о том, как обучить собственную модель распознавания именованных сущностей (Named Entity Recognition, NER), не используя большие языковые модели (LLM), такие как `GPT` или `GigaChat`. Мы рассмотрим процесс от разметки данных до интеграции модели в реальное приложение. Особое внимание уделено практическим примерам и реальным кейсам, где такая модель уже используется.

## Разметка данных: основа обучения

Для обучения модели NER первым делом нужно разметить данные. Например, возьмем фразу:

> "Мы должны разметить посимвольно с 31 по 32 to, это вот оно. С 33 по 39 это location, Москва, вот оно."

Вот как это выглядит в размеченном виде:

- `to` — сущность `TO`
- `Москва` — сущность `LOCATION`

Разметка проводится посимвольно, чтобы модель могла понять, где начинается и заканчивается каждая сущность. Так мы получаем набор примеров, в которых каждое слово или группа слов помечены соответствующими тегами: `TO`, `FROM`, `DATE`, `RETURN`, `LOCATION`, `CHILD`, `ANIMAL` и т.д.

**Важно:** чем больше и разнообразнее примеров, тем лучше модель будет справляться с новыми данными. В нашем случае — 50 примеров, включая фразы с детьми, собаками, бобрами и ежиками.

## Обучение модели

После разметки мы переходим к обучению. Используется несложная нейросеть, которую можно реализовать на `PyTorch` или `TensorFlow`. Код не страшный — он доступен даже для Junior-разработчиков, изучающих машинное обучение.

Модель обучается на 30 эпохах. В процессе обучения отслеживается метрика ошибки — она падает, что говорит о том, что модель учится. Интересно, что модель не только учится на данных, но и обобщает: даже если в обучающих примерах не было упоминания хомяков, она всё равно способна классифицировать их как `ANIMAL`.

## Пример работы модели

Представьте, что у нас есть запрос:

> "Мы с коллегами работаем в Сбербанке, нужны билеты на самый быстрый поезд в Москву из Краснодара. Вечером 5 декабря. Нас четверо. Возвращаемся 7 декабря. С ребенком и собакой. Желательно купе. Бюджет 10 тысяч. Нужна страховка."

Модель распознает:

- `Сбербанк` — `ORGANIZATION`
- `Москва` — `LOCATION`
- `Краснодар` — `LOCATION`
- `5 декабря` — `DATE`
- `7 декабря` — `RETURN DATE`
- `ребенок` — `CHILD`
- `собака` — `ANIMAL`
- `купе` — `LEVEL`
- `10 тысяч` — `BUDGET`

Все сущности выделены корректно, и модель справляется с этим без подсказок и промтов. Это позволяет использовать её в реальных условиях, например, для обработки звонков или текстовых обращений.

## Преимущества собственной модели

Использование собственной модели NER имеет несколько ключевых преимуществ:

- **Независимость от LLM:** не нужно использовать `GPT`, `GigaChat` или другие большие модели.
- **Безопасность:** нет необходимости размещать данные на сторонних серверах.
- **Скорость:** модель работает быстро — в отличие от LLM, где даже простой запрос может занимать 0.8 секунд.
- **Масштабируемость:** модель можно развернуть на собственных серверах и интегрировать в любое приложение.

## Потенциал в реальных проектах

Такие модели уже используются в реальных проектах. Например, в Сбербанке планируется внедрение в начале 2025 года. В будущем модель будет обрабатывать звонки, выделяя улицы, организации, имена, фамилии, типы врачей и другие сущности.

## Кластеризация текстов: второй пример

Второй пример касается кластеризации текстов. Представьте, что у нас есть 20 фраз, описывающих разные темы: NLP, компьютерное зрение, временные ряды. Мы хотим разделить их на три кластера.

Для этого используется модель из библиотеки `Genzyme`. Сначала тексты проходят через **лимитизацию** — приведение к нормальной форме. Например:

- `бегал`, `бежал`, `забегался` → `бегать`
- `собаку`, `собакой`, `собаке` → `собака`

Это помогает алгоритму видеть суть слова, а не просто разные формы. После этого модель кластеризует тексты, и мы получаем три чётко разделённых темы.

## Интеграция в приложение

Как всё это можно использовать в реальности? Вот несколько вариантов:

- **API:** модель можно вынести на веб-сервис и создать API для внешних запросов.
- **Облачные решения:** использовать `Colab` или облачные сервисы для запуска модели.
- **Интеграция в продукт:** встроить модель в приложение, чтобы автоматически обрабатывать тексты, звонки, чаты.

## Заключение

Обучение собственной модели NER — это не только технически интересная задача, но и очень полезный инструмент для реальных проектов. Она позволяет обрабатывать данные быстро, безопасно и без привлечения сторонних LLM. Особенно это актуально для госкомпаний и проектов с жёсткими требованиями к конфиденциальности.

Если вы только начинаете изучать машинное обучение, эта задача станет отличным практическим проектом. А если вы уже на более продвинутом уровне — вы получите ещё один мощный инструмент в своём арсенале.

**P.S.** Автор доклада — разработчик, который каждый раз радуется, что узнаёт что-то новое. И мы надеемся, что эта статья вдохновит вас на новые эксперименты и проекты.