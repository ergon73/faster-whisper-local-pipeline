# Глава 13: Практика с PyTorch и кастомные лоссы

В этой главе мы поговорим о том, как использовать `PyTorch` для решения задач машинного обучения, а также о том, как создавать **кастомные лоссы** — функции потерь, которые лучше отражают специфику вашей задачи.

---

## Почему важны кастомные лоссы?

Стандартные функции потерь, такие как `MSE` или `CrossEntropy`, — это хорошо. Но они не всегда подходят под конкретную задачу. Например, если вы обучаете модель оценивать стоимость недвижимости, и ошибка в 500 000 рублей — это катастрофа, а ошибка в 15 миллионов — вообще критично, то стандартный `MSE` может не сработать.

В таких случаях вы можете написать **свой лосс**, который будет учитывать именно вашу бизнес-логику. Например, вы можете создать функцию, которая будет считать **относительную ошибку**, а не абсолютную. И это можно сделать как в `Keras`, так и в `PyTorch`.

---

## Какие параметры нейросети можно настраивать?

Когда вы работаете с нейросетями, вы можете экспериментировать с:

- количеством нейронов и слоев,
- активационными функциями,
- размером батча,
- пропорциями обучающей, валидационной и тестовой выборок.

Типичное распределение данных:

- 70% — обучающая,
- 20% — валидационная,
- 10% — тестовая.

Иногда используют 60-20-20, но это зависит от задачи.

---

## PyTorch: от сложного к простому

`PyTorch` часто воспринимается как сложная библиотека. Но на самом деле, с ней можно работать **в три строчки кода**, и она сама подберет оптимальную архитектуру и обучит модель за 7 минут. Это как использовать автопилот на Тесле, в то время как вы едете на машине с механической коробкой. Но знание `PyTorch` — это как умение ездить на механике: вы понимаете, как всё работает под капотом.

---

## Где PyTorch применяется?

`PyTorch` особенно полезен в задачах, где стандартные инструменты не справляются. Например:

- сложные нейросети,
- оптимизация на разных видеокартах,
- интеграция в веб-сайты, квадрокоптеры, системы оценки недвижимости и т.д.

Если вы хотите встроить ИИ в реальный продукт, `PyTorch` — отличный выбор.

---

## Почему компании просят PyTorch?

Многие вакансии требуют знаний `PyTorch`. Почему? Потому что:

- `AutoML` и `AutoKeras` — это удобно, но **они не развивают мышление**.
- `PyTorch` требует понимания, как устроены нейросети.
- Он помогает **прокачать IQ** в области машинного обучения.

Вот как это сравнивается: `AutoKeras` — это как водить на автопилоте Теслы. А `PyTorch` — это как научиться водить на механике. Вы понимаете, как работает двигатель, трансмиссия, тормоза. Это **глубокое понимание**.

---

## Зачем изучать PyTorch?

1. **Для трудоустройства**. Многие компании требуют знаний `PyTorch`.
2. **Для карьерного роста**. Знание `PyTorch` открывает двери к более сложным и интересным задачам.
3. **Для повышения IQ**. Работа с `PyTorch` развивает мышление и понимание архитектур нейросетей.
4. **Для выживания в токсичной среде**. В IT часто встречаются "динозавры", которые не понимают современные инструменты. Знание `PyTorch` поможет вам не сойти с дистанции.

---

## PyTorch vs. AutoKeras: как выбирать?

- **AutoKeras** — удобно, быстро, но не развивает.
- **Keras** — универсален, но не всегда подходит для сложных задач.
- **PyTorch** — мощный инструмент, но требует понимания.

Если вы хотите **быстро получить результат**, выбирайте `AutoKeras`. Если вы хотите **понять, как всё работает**, — выбирайте `PyTorch`.

---

## Заключение

Изучение `PyTorch` — это не просто формальность. Это **инвестиция в ваше будущее** в сфере машинного обучения. Вы получите:

- **глубокое понимание** нейросетей,
- **навыки**, которые востребованы на рынке,
- **опыт**, который поможет вам решать сложные задачи.

В рамках курса вы изучите не только `PyTorch`, но и **под сотню библиотек**, включая:

- `Matplotlib`, `NumPy`, `Pandas` для анализа данных,
- `OpenCV`, `PIL`, `MoviePy` для компьютерного зрения,
- `NLTK`, `Gensim`, `PyMorph` для обработки текста,
- `Librosa` и инструменты аудиообработки.

И это только начало.

**PyTorch = IQ + объем знаний + опыт проектов.**

Именно это делает вас **реальным специалистом** в области машинного обучения.