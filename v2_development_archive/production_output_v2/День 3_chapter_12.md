# Персонализация предобученной модели ResNet: от теории к практике

В современном машинном обучении часто используется подход *transfer learning* — когда мы берём уже обученную на большом датасете модель и адаптируем её под свою конкретную задачу. В этой статье мы разберём, как персонализировать предобученную модель `ResNet` для решения задачи классификации: определения, здоров ли человек или больной. Также рассмотрим, как подготовить данные, построить модель в `PyTorch`, и как обучить её с минимальными затратами времени и ресурсов.

---

## Подготовка данных

Первым делом нужно собрать и нормализовать датасет. Для задачи компьютерного зрения, особенно с моделью `ResNet`, важно правильно обработать изображения. Вот основные шаги:

- **Нормализация изображений**: `ImageNet` рекомендует использовать определённые коэффициенты нормализации. Это важно, потому что модель обучалась именно на таких данных.
- **Создание трейн- и тестовых наборов**: данные берутся из нужных папок, формируются `DataLoader`-ы. Обучающий набор перемешивается, тестовый — нет.
- **Размеры батчей и выборки**: батчи по 32 картинки. Всего 4172 обучающих и 1044 тестовых изображений.

---

## Загрузка и адаптация модели ResNet

Модель `ResNet-18` — это сверточная сеть с 18 слоями. Она уже предобучена на `ImageNet` и умеет выделять визуальные признаки: формы, углы, текстуры и т.д.

### Структура модели

- **Тело модели**: 17 сверточных слоев. Отвечает за извлечение признаков.
- **Голова модели**: финальный слой с 1000 нейронами. Отвечает за классификацию (1000 классов: люди, машины, птицы и т.д.).

### Персонализация модели

Чтобы адаптировать `ResNet` под нашу задачу, мы:

1. Загружаем модель: