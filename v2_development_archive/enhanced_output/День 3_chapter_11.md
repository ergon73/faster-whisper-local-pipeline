# Обучение нейросети: градиенты, ошибки и PyTorch

В этой статье мы разберем, как происходит обучение нейросети, что такое градиенты и как они влияют на процесс, а также как оценивать точность модели на тестовых данных. Мы будем использовать библиотеку `PyTorch`, которая позволяет гибко управлять архитектурой нейросети и процессом обучения.

---

## Как работает обучение нейросети

Обучение нейросети — это итеративный процесс, в котором модель учится на данных, корректируя свои внутренние параметры (веса) с помощью градиентов.

### Основные шаги обучения:

1. **Выбор батча** — данные разбиваются на порции (батчи), например, по 64 изображениям.
2. **Прямой проход** — модель делает предсказания на основе текущих весов.
3. **Вычисление ошибки (loss)** — сравниваем предсказания с правильными ответами.
4. **Обратное распространение ошибки (backpropagation)** — вычисляем градиенты, которые показывают, как нужно изменить веса, чтобы уменьшить ошибку.
5. **Обновление весов** — с помощью оптимизатора (например, `optimizer.step()`) обновляем веса модели.

Эти шаги повторяются для каждого батча, а после обработки всех батчей — для всей эпохи. В конце эпохи мы вычисляем **среднюю ошибку** и выводим её на экран.

---

## Что такое градиент?

**Градиент** — это вектор, который показывает, в каком направлении и насколько нужно изменить веса модели, чтобы уменьшить ошибку.

- **Вес** — это текущее значение параметра модели.
- **Градиент** — это направление и величина изменения веса.

Проще говоря: вес — это то, что есть, а градиент — это то, как мы его меняем.

---

## Эффект убывающего градиента

Один из интересных явлений в глубоких нейросетях — **убывающий градиент**. Он проявляется в том, что градиенты на более ранних слоях сети становятся меньше, чем на поздних.

- **Последние слои** — градиенты большие, слои учатся быстро.
- **Средние слои** — градиенты уже меньше.
- **Первые слои** — градиенты минимальны, обучение идет медленно.

Это может привести к проблемам с обучением глубоких сетей. Существуют методы компенсации, такие как **использование ReLU**, **BatchNorm**, **ResNet** и другие.

---

## Как оценивать точность модели

После обучения модель нужно проверить на тестовых данных. Это делается следующим образом:

1. **Переключаем модель в режим оценки**: