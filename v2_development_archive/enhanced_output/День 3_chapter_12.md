# Персонализация предобученной модели ResNet: от теории к практике

В современных задачах машинного обучения часто используется подход **переноса обучения** (transfer learning), когда мы берём уже обученную на большом датасете модель и адаптируем её под конкретную задачу. В этой статье мы рассмотрим, как персонализировать предобученную модель `ResNet` в `PyTorch` для решения задачи классификации изображений — определения, здоров ли человек или больной.

---

## Подготовка данных

Первым шагом в любом проекте машинного обучения является **подготовка данных**. В данном случае мы работаем с изображениями, и важно нормализовать их в соответствии с тем, как они были обработаны при обучении модели на `ImageNet`.

### Нормализация изображений

Для `ImageNet` рекомендуется использовать следующие коэффициенты нормализации:

- Средние значения: `[0.485, 0.456, 0.406]`
- Стандартные отклонения: `[0.229, 0.224, 0.225]`

Это позволяет модели лучше справляться с новыми изображениями, так как они будут в том же диапазоне, что и данные, на которых модель была обучена.

### Создание датасетов

Мы создаём два набора данных:

- **Тренировочный датасет** — из нужных папок, с перемешиванием.
- **Тестовый датасет** — без перемешивания, для оценки обобщающей способности модели.

Размеры:

- Обучающих изображений: 4172
- Тестовых: 1044
- Размер батча: 32

---

## Загрузка и настройка модели ResNet

Модель `ResNet-18` — это свёрточная нейросеть с 18 слоями, которая хорошо обучена на `ImageNet`. Её архитектура включает:

- **Тело модели** — 17 свёрточных слоёв, отвечающих за извлечение визуальных признаков.
- **Голова модели** — финальный слой, который классифицирует изображения на 1000 классов (люди, животные, объекты и т.д.).

### Персонализация модели

Чтобы адаптировать `ResNet` под нашу задачу (классификация "здоровый / больной"), нам нужно:

1. Загрузить предобученную модель.
2. Узнать, сколько входных параметров у последнего слоя.
3. Заменить финальный слой на новый с **2 нейронами** — по одному на каждый класс.